/*!--------------------------------------------------------
 * Copyright (C) Microsoft Corporation. All rights reserved.
 *--------------------------------------------------------*/
(function(){var t=["require","exports","vs/base/common/winjs.base","vs/nls!vs/workbench/parts/git/browser/gitViewlet","vs/nls","vs/css!vs/workbench/parts/git/browser/gitViewlet","vs/base/common/eventEmitter","vs/base/browser/builder","vs/workbench/parts/git/common/git","vs/platform/instantiation/common/instantiation","vs/base/browser/dom","vs/base/common/platform","vs/platform/workspace/common/workspace","vs/base/common/lifecycle","vs/platform/message/common/message","vs/workbench/parts/git/browser/gitActions","vs/base/common/paths","vs/nls!vs/workbench/parts/git/browser/views/notroot/notrootView","vs/nls!vs/workbench/parts/git/browser/views/noworkspace/noworkspaceView","vs/workbench/parts/git/browser/views/disabled/disabledView","vs/css!vs/workbench/parts/git/browser/views/disabled/disabledView","vs/css!vs/workbench/parts/git/browser/views/empty/emptyView","vs/css!vs/workbench/parts/git/browser/views/gitless/gitlessView","vs/css!vs/workbench/parts/git/browser/views/huge/hugeView","vs/css!vs/workbench/parts/git/browser/views/notroot/notrootView","vs/workbench/parts/git/browser/views/gitless/gitlessView","vs/css!vs/workbench/parts/git/browser/views/noworkspace/noworkspaceView","vs/nls!vs/workbench/parts/git/browser/views/changes/changesView","vs/workbench/parts/git/browser/views/notroot/notrootView","vs/workbench/parts/git/browser/views/noworkspace/noworkspaceView","vs/workbench/parts/git/browser/views/huge/hugeView","vs/css!vs/workbench/parts/git/browser/media/gitViewlet","vs/css!vs/workbench/parts/git/browser/views/changes/changesView","vs/base/common/errors","vs/base/browser/ui/button/button","vs/workbench/parts/git/browser/views/changes/changesViewer","vs/nls!vs/workbench/parts/git/browser/views/changes/changesViewer","vs/base/common/severity","vs/workbench/parts/git/browser/views/empty/emptyView","vs/base/browser/ui/actionbar/actionbar","vs/nls!vs/workbench/parts/git/browser/views/disabled/disabledView","vs/workbench/parts/git/browser/views/changes/changesView","vs/base/common/keyCodes","vs/nls!vs/workbench/parts/git/browser/views/empty/emptyView","vs/workbench/parts/git/common/gitModel","vs/nls!vs/workbench/parts/git/browser/views/gitless/gitlessView","vs/platform/contextview/browser/contextView","vs/nls!vs/workbench/parts/git/browser/views/huge/hugeView","vs/workbench/common/editor","vs/base/parts/tree/browser/treeDefaults","vs/base/common/uri","vs/base/parts/tree/browser/tree","vs/base/browser/ui/countBadge/countBadge","vs/base/common/strings","vs/base/browser/keyboardEvent","vs/base/common/actions","vs/base/parts/tree/browser/treeImpl","vs/workbench/parts/git/browser/gitEditorInputs","vs/workbench/parts/files/common/files","vs/workbench/parts/output/common/output","vs/base/parts/tree/browser/treeDnd","vs/base/browser/ui/inputbox/inputBox","vs/workbench/services/editor/common/editorService","vs/platform/event/common/event","vs/workbench/services/group/common/groupService","vs/platform/configuration/common/configuration","vs/base/common/comparers","vs/platform/files/common/files","vs/workbench/parts/git/browser/gitViewlet","vs/workbench/browser/viewlet","vs/workbench/parts/git/browser/gitWorkbenchContributions","vs/platform/progress/common/progress","vs/platform/telemetry/common/telemetry"],e=function(e){for(var n=[],i=0,r=e.length;i<r;i++)n[i]=t[e[i]];return n};define(t[31],e([5]),{}),define(t[32],e([5]),{}),define(t[20],e([5]),{}),define(t[21],e([5]),{}),define(t[22],e([5]),{}),define(t[23],e([5]),{}),define(t[24],e([5]),{}),define(t[26],e([5]),{}),define(t[27],e([4,3]),function(t,e){return t.create("vs/workbench/parts/git/browser/views/changes/changesView",e)}),define(t[36],e([4,3]),function(t,e){return t.create("vs/workbench/parts/git/browser/views/changes/changesViewer",e)}),define(t[40],e([4,3]),function(t,e){return t.create("vs/workbench/parts/git/browser/views/disabled/disabledView",e)}),define(t[43],e([4,3]),function(t,e){return t.create("vs/workbench/parts/git/browser/views/empty/emptyView",e)}),define(t[45],e([4,3]),function(t,e){return t.create("vs/workbench/parts/git/browser/views/gitless/gitlessView",e)}),define(t[47],e([4,3]),function(t,e){return t.create("vs/workbench/parts/git/browser/views/huge/hugeView",e)}),define(t[17],e([4,3]),function(t,e){return t.create("vs/workbench/parts/git/browser/views/notroot/notrootView",e)}),define(t[18],e([4,3]),function(t,e){return t.create("vs/workbench/parts/git/browser/views/noworkspace/noworkspaceView",e)});var n=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};define(t[19],e([0,1,40,2,6,7,20]),function(t,e,i,r,o,s){"use strict";var a=s.$,c=function(t){function e(){t.apply(this,arguments),this.ID="disabled"}return n(e,t),Object.defineProperty(e.prototype,"element",{get:function(){return this._element||this.render(),this._element},enumerable:!0,configurable:!0}),e.prototype.render=function(){this._element=a(['<div class="disabled-view">',"<p>",i.localize(0,null),"</p>","</div>"].join("")).getHTMLElement()},e.prototype.focus=function(){},e.prototype.layout=function(t){},e.prototype.setVisible=function(t){return r.TPromise.as(null)},e.prototype.getControl=function(){return null},e.prototype.getActions=function(){return[]},e.prototype.getSecondaryActions=function(){return[]},e}(o.EventEmitter);e.DisabledView=c});var i=this&&this.__decorate||function(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},r=this&&this.__param||function(t,e){return function(n,i){e(n,i,t)}};define(t[25],e([0,1,45,11,2,6,7,12,22]),function(t,e,o,s,a,c,u,l){"use strict";var p=u.$,h=function(t){function e(e){t.call(this),this.ID="gitless",this._contextService=e}return n(e,t),Object.defineProperty(e.prototype,"element",{get:function(){return this._element||this.render(),this._element},enumerable:!0,configurable:!0}),e.prototype.render=function(){var t;t=s.isMacintosh?o.localize(0,null,'<a href="http://brew.sh/" tabindex="0" target="_blank">Homebrew</a>','<a href="http://git-scm.com/download/mac" tabindex="0" target="_blank">git-scm.com</a>','<a href="https://developer.apple.com/xcode/" tabindex="0" target="_blank">XCode</a>',"<code>git</code>"):s.isWindows?o.localize(1,null,'<a href="https://chocolatey.org/packages/git" tabindex="0" target="_blank">Chocolatey</a>','<a href="http://git-scm.com/download/win" tabindex="0" target="_blank">git-scm.com</a>'):s.isLinux?o.localize(2,null,'<a href="http://git-scm.com/download/linux" tabindex="0" target="_blank">git-scm.com</a>'):o.localize(3,null,'<a href="http://git-scm.com/download" tabindex="0" target="_blank">git-scm.com</a>'),this._element=p(['<div class="gitless-view">',"<p>",o.localize(4,null),"</p>","<p>",t,"</p>","<p>",o.localize(5,null,this._contextService.getConfiguration().env.appName),"</p>","</div>"].join("")).getHTMLElement()},e.prototype.focus=function(){},e.prototype.layout=function(t){},e.prototype.setVisible=function(t){return a.TPromise.as(null)},e.prototype.getControl=function(){return null},e.prototype.getActions=function(){return[]},e.prototype.getSecondaryActions=function(){return[]},e=i([r(0,l.IWorkspaceContextService)],e)}(c.EventEmitter);e.GitlessView=h}),define(t[28],e([0,1,17,2,6,7,24]),function(t,e,i,r,o,s){"use strict";var a=s.$,c=function(t){function e(){t.apply(this,arguments),this.ID="notroot"}return n(e,t),Object.defineProperty(e.prototype,"element",{get:function(){return this._element||this.render(),this._element},enumerable:!0,configurable:!0}),e.prototype.render=function(){this._element=a(['<div class="notroot-view">',"<p>",i.localize(0,null),"</p>","<p>",i.localize(1,null),"</p>","</div>"].join("")).getHTMLElement()},e.prototype.focus=function(){},e.prototype.layout=function(t){},e.prototype.setVisible=function(t){return r.TPromise.as(null)},e.prototype.getControl=function(){return null},e.prototype.getActions=function(){return[]},e.prototype.getSecondaryActions=function(){return[]},e}(o.EventEmitter);e.NotRootView=c}),define(t[29],e([0,1,18,2,6,7,26]),function(t,e,i,r,o,s){"use strict";var a=s.$,c=function(t){function e(){t.apply(this,arguments),this.ID="noworkspace"}return n(e,t),Object.defineProperty(e.prototype,"element",{get:function(){return this._element||this.render(),this._element},enumerable:!0,configurable:!0}),e.prototype.render=function(){this._element=a(['<div class="noworkspace-view">',"<p>",i.localize(0,null),"</p>","<p>",i.localize(1,null),"</p>","</div>"].join("")).getHTMLElement()},e.prototype.focus=function(){},e.prototype.layout=function(t){},e.prototype.setVisible=function(t){return r.TPromise.as(null)},e.prototype.getControl=function(){return null},e.prototype.getActions=function(){return[]},e.prototype.getSecondaryActions=function(){return[]},e}(o.EventEmitter);e.NoWorkspaceView=c}),define(t[30],e([0,1,47,2,6,10,8,33,34,23]),function(t,e,o,s,a,c,u,l,p){"use strict";var h=c.emmet,g=function(t){function e(e){t.call(this),this.gitService=e,this.ID="huge"}return n(e,t),Object.defineProperty(e.prototype,"element",{get:function(){return this._element||this.render(),this._element},enumerable:!0,configurable:!0}),e.prototype.render=function(){var t=this;this._element=h(".huge-view"),c.append(this._element,h("p")).textContent=o.localize(0,null);var e=c.append(this._element,h("p"));c.append(e,document.createTextNode(o.localize(1,null))),c.append(e,document.createTextNode(" "));var n=c.append(e,h("pre"));n.style.display="inline",n.textContent="git.allowLargeRepositories";var i=new p.Button(this._element);i.label=o.localize(2,null),i.addListener2("click",function(e){c.EventHelper.stop(e),t.gitService.allowHugeRepositories=!0,t.gitService.status().done(null,l.onUnexpectedError)})},e.prototype.focus=function(){},e.prototype.layout=function(t){},e.prototype.setVisible=function(t){return s.TPromise.as(null)},e.prototype.getControl=function(){return null},e.prototype.getActions=function(){return[]},e.prototype.getSecondaryActions=function(){return[]},e=i([r(0,u.IGitService)],e)}(a.EventEmitter);e.HugeView=g}),define(t[35],e([0,1,2,36,11,16,37,10,66,39,52,51,60,49,8,44,15,46,9,14,42,12,50]),function(t,e,o,s,a,c,u,l,p,h,g,f,v,d,S,m,E,y,w,b,D,T,I){"use strict";function A(t){return a.isWindows?t.replace(/\//g,"\\"):t}var _=S.IGitService,R=l.emmet,C=function(){function t(t){this.cache={},this.instantiationService=t}return t.prototype.getAction=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var i=this.cache[t.ID];return i||(e.unshift(t),i=this.cache[t.ID]=this.instantiationService.createInstance.apply(this.instantiationService,e)),i},t.prototype.dispose=function(){var t=this;Object.keys(this.cache).forEach(function(e){t.cache[e].dispose()}),this.cache=null},t}();e.ActionContainer=C;var O=function(){function t(){}return t.prototype.getId=function(t,e){if(e instanceof m.StatusModel)return"root";if(e instanceof m.StatusGroup){var n=e;switch(n.getType()){case S.StatusType.INDEX:return"index";case S.StatusType.WORKING_TREE:return"workingTree";case S.StatusType.MERGE:return"merge";default:throw new Error("Invalid group type")}}var i=e;return i.getId()},t.prototype.hasChildren=function(t,e){if(e instanceof m.StatusModel)return!0;if(e instanceof m.StatusGroup){var n=e;return n.all().length>0}},t.prototype.getChildren=function(t,e){if(e instanceof m.StatusModel){var n=e;return o.TPromise.as(n.getGroups())}if(e instanceof m.StatusGroup){var i=e;return o.TPromise.as(i.all())}return o.TPromise.as([])},t.prototype.getParent=function(t,e){return o.TPromise.as(null)},t}();e.DataSource=O;var V=function(t){function e(e,n){t.call(this,e),this.gitService=n}return n(e,t),e.prototype.hasActions=function(t,e){return e instanceof m.FileStatus||e instanceof m.StatusGroup&&e.all().length>0},e.prototype.getActions=function(t,e){return e instanceof m.StatusGroup?o.TPromise.as(this.getActionsForGroupStatusType(e.getType())):o.TPromise.as(this.getActionsForFileStatusType(e.getType()))},e.prototype.getActionsForFileStatusType=function(t){switch(t){case S.StatusType.INDEX:return[this.getAction(E.UnstageAction)];case S.StatusType.WORKING_TREE:return[this.getAction(E.UndoAction),this.getAction(E.StageAction)];case S.StatusType.MERGE:return[this.getAction(E.StageAction)];default:return[]}},e.prototype.getActionsForGroupStatusType=function(t){switch(t){case S.StatusType.INDEX:return[this.getAction(E.GlobalUnstageAction)];case S.StatusType.WORKING_TREE:return[this.getAction(E.GlobalUndoAction),this.getAction(E.GlobalStageAction)];case S.StatusType.MERGE:return[this.getAction(E.StageAction)];default:return[]}},e.prototype.hasSecondaryActions=function(t,e){return this.hasActions(t,e)},e.prototype.getSecondaryActions=function(t,e){var n=this;return this.getActions(t,e).then(function(t){if(e instanceof m.FileStatus){var i=e,r=i.getStatus();t.push(new h.Separator),r!==S.Status.DELETED&&r!==S.Status.INDEX_DELETED&&t.push(n.getAction(E.OpenFileAction)),t.push(n.getAction(E.OpenChangeAction))}return t.reverse(),t})},e.prototype.getActionItem=function(t,e,n){return null},e=i([r(0,w.IInstantiationService),r(1,_)],e)}(C);e.ActionProvider=V;var G=function(){function t(t,e,n,i,r){this.actionProvider=t,this.actionRunner=e,this.messageService=n,this.gitService=i,this.contextService=r}return t.prototype.getHeight=function(t,e){return 22},t.prototype.getTemplateId=function(t,e){if(e instanceof m.StatusGroup)switch(e.getType()){case S.StatusType.INDEX:return"index";case S.StatusType.WORKING_TREE:return"workingTree";case S.StatusType.MERGE:return"merge"}if(e instanceof m.FileStatus)switch(e.getType()){case S.StatusType.INDEX:return"file:index";case S.StatusType.WORKING_TREE:return"file:workingTree";case S.StatusType.MERGE:return"file:merge"}return null},t.prototype.renderTemplate=function(e,n,i){return/^file:/.test(n)?this.renderFileStatusTemplate(t.templateIdToStatusType(n),i):this.renderStatusGroupTemplate(t.templateIdToStatusType(n),i)},t.prototype.renderStatusGroupTemplate=function(t,e){var n=this,i=Object.create(null);switch(i.root=l.append(e,R(".status-group")),t){case S.StatusType.INDEX:i.root.textContent=s.localize(0,null);break;case S.StatusType.WORKING_TREE:i.root.textContent=s.localize(1,null);break;case S.StatusType.MERGE:i.root.textContent=s.localize(2,null)}var r=l.append(e,R(".count-badge-wrapper"));return i.count=new g.CountBadge(r),i.actionBar=new h.ActionBar(e,{actionRunner:this.actionRunner}),i.actionBar.push(this.actionProvider.getActionsForGroupStatusType(t),{icon:!0,label:!1}),i.actionBar.addListener2("run",function(t){return t.error&&n.onError(t.error)}),i},t.prototype.renderFileStatusTemplate=function(t,e){var n=this,i=Object.create(null);i.root=l.append(e,R(".file-status")),i.status=l.append(i.root,R("span.status")),i.name=l.append(i.root,R("a.name.plain")),i.folder=l.append(i.root,R("span.folder"));var r=l.append(i.root,R("span.rename")),o=l.append(r,R("span.rename-arrow"));return o.textContent="â†",i.renameName=l.append(r,R("span.rename-name")),i.renameFolder=l.append(r,R("span.rename-folder")),i.actionBar=new h.ActionBar(e,{actionRunner:this.actionRunner}),i.actionBar.push(this.actionProvider.getActionsForFileStatusType(t),{icon:!0,label:!1}),i.actionBar.addListener2("run",function(t){return t.error&&n.onError(t.error)}),i},t.prototype.renderElement=function(e,n,i,r){/^file:/.test(i)?this.renderFileStatus(e,n,r):t.renderStatusGroup(n,r)},t.renderStatusGroup=function(t,e){e.actionBar.context=t,e.count.setCount(t.all().length)},t.prototype.renderFileStatus=function(e,n,i){i.actionBar.context={tree:e,fileStatus:n};var r=this.gitService.getModel().getRepositoryRoot(),o=this.contextService.getWorkspace().resource.fsPath,a=n.getStatus(),u=n.getRename(),l=n.getPath(),p=l.lastIndexOf("/"),h=p===-1?l:l.substr(p+1,l.length),g=p===-1?"":l.substr(0,p);i.root.className="file-status "+t.statusToClass(a),i.status.textContent=t.statusToChar(a),i.status.title=t.statusToTitle(a);var f=I["default"].file(c.normalize(c.join(r,l))),v=c.isEqualOrParent(f.fsPath,o),d="",S="";if(u){var m=u.lastIndexOf("/");d=m===-1?u:u.substr(m+1,u.length),S=m===-1?"":u.substr(0,m),i.renameName.textContent=h,i.renameFolder.textContent=g;var E=I["default"].file(c.normalize(c.join(r,u)));v=c.isEqualOrParent(E.fsPath,o)}v?i.root.title="":(i.root.title=s.localize(3,null),i.root.className+=" out-of-workspace"),i.name.textContent=d||h,i.name.title=u||l,i.folder.textContent=A(S||g)},t.prototype.disposeTemplate=function(e,n,i){/^file:/.test(n)&&t.disposeFileStatusTemplate(i)},t.disposeFileStatusTemplate=function(t){t.actionBar.dispose()},t.statusToChar=function(t){switch(t){case S.Status.INDEX_MODIFIED:return s.localize(4,null);case S.Status.MODIFIED:return s.localize(5,null);case S.Status.INDEX_ADDED:return s.localize(6,null);case S.Status.INDEX_DELETED:return s.localize(7,null);case S.Status.DELETED:return s.localize(8,null);case S.Status.INDEX_RENAMED:return s.localize(9,null);case S.Status.INDEX_COPIED:return s.localize(10,null);case S.Status.UNTRACKED:return s.localize(11,null);case S.Status.IGNORED:return s.localize(12,null);case S.Status.BOTH_DELETED:return s.localize(13,null);case S.Status.ADDED_BY_US:return s.localize(14,null);case S.Status.DELETED_BY_THEM:return s.localize(15,null);case S.Status.ADDED_BY_THEM:return s.localize(16,null);case S.Status.DELETED_BY_US:return s.localize(17,null);case S.Status.BOTH_ADDED:return s.localize(18,null);case S.Status.BOTH_MODIFIED:return s.localize(19,null);default:return""}},t.statusToTitle=function(t){switch(t){case S.Status.INDEX_MODIFIED:return s.localize(20,null);case S.Status.MODIFIED:return s.localize(21,null);case S.Status.INDEX_ADDED:return s.localize(22,null);case S.Status.INDEX_DELETED:return s.localize(23,null);case S.Status.DELETED:return s.localize(24,null);case S.Status.INDEX_RENAMED:return s.localize(25,null);case S.Status.INDEX_COPIED:return s.localize(26,null);case S.Status.UNTRACKED:return s.localize(27,null);case S.Status.IGNORED:return s.localize(28,null);case S.Status.BOTH_DELETED:return s.localize(29,null);case S.Status.ADDED_BY_US:return s.localize(30,null);case S.Status.DELETED_BY_THEM:return s.localize(31,null);case S.Status.ADDED_BY_THEM:return s.localize(32,null);case S.Status.DELETED_BY_US:return s.localize(33,null);case S.Status.BOTH_ADDED:return s.localize(34,null);case S.Status.BOTH_MODIFIED:return s.localize(35,null);default:return""}},t.statusToClass=function(t){switch(t){case S.Status.INDEX_MODIFIED:return"modified";case S.Status.MODIFIED:return"modified";case S.Status.INDEX_ADDED:return"added";case S.Status.INDEX_DELETED:return"deleted";case S.Status.DELETED:return"deleted";case S.Status.INDEX_RENAMED:return"renamed";case S.Status.INDEX_COPIED:return"copied";case S.Status.UNTRACKED:return"untracked";case S.Status.IGNORED:return"ignored";case S.Status.BOTH_DELETED:return"conflict both-deleted";case S.Status.ADDED_BY_US:return"conflict added-by-us";case S.Status.DELETED_BY_THEM:return"conflict deleted-by-them";case S.Status.ADDED_BY_THEM:return"conflict added-by-them";case S.Status.DELETED_BY_US:return"conflict deleted-by-us";case S.Status.BOTH_ADDED:return"conflict both-added";case S.Status.BOTH_MODIFIED:return"conflict both-modified";default:return""}},t.templateIdToStatusType=function(t){return/index$/.test(t)?S.StatusType.INDEX:/workingTree$/.test(t)?S.StatusType.WORKING_TREE:S.StatusType.MERGE},t.prototype.onError=function(t){this.messageService.show(u["default"].Error,t)},t=i([r(2,b.IMessageService),r(3,_),r(4,T.IWorkspaceContextService)],t)}();e.Renderer=G;var M=function(){function t(){}return t.prototype.isVisible=function(t,e){if(e instanceof m.StatusGroup){var n=e;switch(n.getType()){case S.StatusType.INDEX:case S.StatusType.MERGE:return n.all().length>0;case S.StatusType.WORKING_TREE:return!0}}return!0},t}();e.Filter=M;var P=function(){function t(){}return t.prototype.compare=function(e,n,i){return n instanceof m.FileStatus&&i instanceof m.FileStatus?t.compareStatus(n,i):0},t.compareStatus=function(t,e){for(var n,i,r,o,s=t.getPathComponents(),a=e.getPathComponents(),c=s.length-1,u=a.length-1,l=0;;l++){if(n=c===l,i=u===l,n&&i)return p.compareFileNames(s[l],a[l]);if(n)return-1;if(i)return 1;if((r=s[l].toLowerCase())!==(o=a[l].toLowerCase()))return r<o?-1:1}},t}();e.Sorter=P;var N=function(t){function e(e,n,i){t.call(this,e),this.gitService=n,this.messageService=i}return n(e,t),e.prototype.getDragURI=function(t,e){if(e instanceof m.StatusGroup){var n=e;return"git:"+n.getType()}if(e instanceof m.FileStatus){var i=e;return"git:"+i.getType()+":"+i.getPath()}return null},e.prototype.onDragStart=function(t,e,n){},e.prototype.onDragOver=function(t,e,n,i){if(!this.gitService.isIdle())return f.DRAG_OVER_REJECT;if(!(e instanceof v.ElementsDragAndDropData))return f.DRAG_OVER_REJECT;var r=e.getData(),o=r[0];if(o instanceof m.StatusGroup){var s=o;return this.onDrag(n,s.getType())}if(o instanceof m.FileStatus){var a=o;return this.onDrag(n,a.getType())}return f.DRAG_OVER_REJECT},e.prototype.onDrag=function(t,e){return e===S.StatusType.WORKING_TREE?this.onDragWorkingTree(t):e===S.StatusType.INDEX?this.onDragIndex(t):e===S.StatusType.MERGE?this.onDragMerge(t):f.DRAG_OVER_REJECT},e.prototype.onDragWorkingTree=function(t){if(t instanceof m.StatusGroup){var e=t;return e.getType()===S.StatusType.INDEX?f.DRAG_OVER_ACCEPT_BUBBLE_DOWN:f.DRAG_OVER_REJECT}if(t instanceof m.FileStatus){var n=t;return n.getType()===S.StatusType.INDEX?f.DRAG_OVER_ACCEPT_BUBBLE_UP:f.DRAG_OVER_REJECT}return f.DRAG_OVER_REJECT},e.prototype.onDragIndex=function(t){if(t instanceof m.StatusGroup){var e=t;return e.getType()===S.StatusType.WORKING_TREE?f.DRAG_OVER_ACCEPT_BUBBLE_DOWN:f.DRAG_OVER_REJECT}if(t instanceof m.FileStatus){var n=t;return n.getType()===S.StatusType.WORKING_TREE?f.DRAG_OVER_ACCEPT_BUBBLE_UP:f.DRAG_OVER_REJECT}return f.DRAG_OVER_REJECT},e.prototype.onDragMerge=function(t){if(t instanceof m.StatusGroup){var e=t;return e.getType()===S.StatusType.INDEX?f.DRAG_OVER_ACCEPT_BUBBLE_DOWN:f.DRAG_OVER_REJECT}if(t instanceof m.FileStatus){var n=t;return n.getType()===S.StatusType.INDEX?f.DRAG_OVER_ACCEPT_BUBBLE_UP:f.DRAG_OVER_REJECT}return f.DRAG_OVER_REJECT},e.prototype.drop=function(t,e,n,i){var r,o=this,s=e.getData(),a=s[0];r=a instanceof m.StatusGroup?a.all():s;var c=n;c.getType()===S.StatusType.INDEX&&this.getAction(E.StageAction).run(r).done(null,function(t){return o.onError(t)}),c.getType()===S.StatusType.WORKING_TREE&&this.getAction(E.UnstageAction).run(r).done(null,function(t){return o.onError(t)})},e.prototype.onError=function(t){this.messageService.show(u["default"].Error,t)},e=i([r(0,w.IInstantiationService),r(1,_),r(2,b.IMessageService)],e)}(C);e.DragAndDrop=N;var B=function(){function t(){}return t.prototype.getAriaLabel=function(t,e){if(e instanceof m.FileStatus){var n=e,i=n.getStatus(),r=n.getPath(),o=r.lastIndexOf("/"),a=o===-1?r:r.substr(o+1,r.length),c=o===-1?"":r.substr(0,o);return s.localize(36,null,a,c,G.statusToTitle(i))}if(e instanceof m.StatusGroup)switch(e.getType()){case S.StatusType.INDEX:return s.localize(37,null);case S.StatusType.WORKING_TREE:return s.localize(38,null);case S.StatusType.MERGE:return s.localize(39,null)}},t}();e.AccessibilityProvider=B;var k=function(t){function e(e,n){t.call(this,{clickBehavior:d.ClickBehavior.ON_MOUSE_UP}),this.actionProvider=e,this.contextMenuService=n,this.downKeyBindingDispatcher.set(D.CommonKeybindings.SHIFT_UP_ARROW,this.onUp.bind(this)),this.downKeyBindingDispatcher.set(D.CommonKeybindings.SHIFT_DOWN_ARROW,this.onDown.bind(this)),this.downKeyBindingDispatcher.set(D.CommonKeybindings.SHIFT_PAGE_UP,this.onPageUp.bind(this)),this.downKeyBindingDispatcher.set(D.CommonKeybindings.SHIFT_PAGE_DOWN,this.onPageDown.bind(this))}return n(e,t),e.prototype.onLeftClick=function(e,n,i){if(n instanceof m.StatusGroup)return i.preventDefault(),i.stopPropagation(),!0;if(i.shiftKey){var r=e.getFocus();if(!(r instanceof m.FileStatus&&n instanceof m.FileStatus))return;var o=r,s=n;if(o.getType()!==s.getType())return;return void(this.canSelect(e,n)&&(e.setFocus(n),e.isSelected(n)?e.deselectRange(o,s):e.selectRange(o,s)))}return e.setFocus(n),(a.isMacintosh?i.metaKey:i.ctrlKey)?void(this.canSelect(e,n)&&e.toggleSelection(n,{origin:"mouse",originalEvent:i})):t.prototype.onLeftClick.call(this,e,n,i)},e.prototype.onEnter=function(e,n){var i=e.getFocus();return i instanceof m.StatusGroup?(n.preventDefault(),n.stopPropagation(),!0):t.prototype.onEnter.call(this,e,n)},e.prototype.onSpace=function(t,e){var n=t.getFocus();return n?!!this.canSelect(t,n)&&(t.toggleSelection(n,{origin:"keyboard",originalEvent:e}),e.preventDefault(),e.stopPropagation(),!0):(e.preventDefault(),e.stopPropagation(),!0)},e.prototype.onContextMenu=function(t,e,n){var i=this;if(n.target&&n.target.tagName&&"input"===n.target.tagName.toLowerCase())return!1;if(n.preventDefault(),n.stopPropagation(),t.setFocus(e),this.actionProvider.hasSecondaryActions(t,e)){var r={x:n.posx+1,y:n.posy},o={selection:t.getSelection(),focus:e};return this.contextMenuService.showContextMenu({getAnchor:function(){return r},getActions:function(){return i.actionProvider.getSecondaryActions(t,e)},getActionItem:this.actionProvider.getActionItem.bind(this.actionProvider,t,e),getActionsContext:function(){return o},onHide:function(e){e&&t.DOMFocus()}}),!0}return!1},e.prototype.onLeft=function(t,e){return!0},e.prototype.onRight=function(t,e){return!0},e.prototype.onUp=function(e,n){var i=e.getFocus(),r=t.prototype.onUp.call(this,e,n);return!(!r||!n.shiftKey)&&this.shiftSelect(e,i,n)},e.prototype.onPageUp=function(e,n){var i=e.getFocus(),r=t.prototype.onPageUp.call(this,e,n);return!(!r||!n.shiftKey)&&this.shiftSelect(e,i,n)},e.prototype.onDown=function(e,n){var i=e.getFocus(),r=t.prototype.onDown.call(this,e,n);return!(!r||!n.shiftKey)&&this.shiftSelect(e,i,n)},e.prototype.onPageDown=function(e,n){var i=e.getFocus(),r=t.prototype.onPageDown.call(this,e,n);return!(!r||!n.shiftKey)&&this.shiftSelect(e,i,n)},e.prototype.canSelect=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return!e.some(function(t){return t instanceof m.StatusGroup||t instanceof m.StatusModel})&&e.every(function(e){var n=t.getSelection()[0],i=e;return!n||n.getType()===i.getType()})},e.prototype.shiftSelect=function(t,e,n){var i={origin:"keyboard",originalEvent:n},r=t.getFocus();if(r===e)return!1;var o=t.isSelected(e),s=t.isSelected(r);return o&&s?t.deselectRange(r,e,i):o||s?o?this.canSelect(t,r)&&t.selectRange(r,e,i):t.deselectRange(r,e,i):this.canSelect(t,e,r)&&t.selectRange(r,e,i),!0},e=i([r(1,y.IContextMenuService)],e)}(d.DefaultController);e.Controller=k}),define(t[41],e([0,1,27,11,13,6,53,33,16,2,7,54,55,39,56,8,15,44,35,57,58,59,48,61,37,62,46,9,14,12,63,42,64,65,32]),function(t,e,o,s,a,c,u,l,p,h,g,f,v,d,S,m,E,y,w,b,D,T,I,A,_,R,C,O,V,G,M,P,N,B){"use strict";var k=m.IGitService,x=g.$,L=function(t){function e(e,n,i,r,o,s,a,c,u,p,h){var g=this;t.call(this),this.configurationService=h,this.ID="changes",this.instantiationService=n,this.editorService=i,this.messageService=o,this.contextViewService=s,this.contextService=a,this.gitService=c,this.outputService=u,this.visible=!1,this.currentDimension=null,this.actionRunner=e,this.toDispose=[this.smartCommitAction=this.instantiationService.createInstance(E.SmartCommitAction,this),r.onEditorsChanged(function(){return g.onEditorsChanged(g.editorService.getActiveEditorInput()).done(null,l.onUnexpectedError)}),this.gitService.addListener2(m.ServiceEvents.OPERATION_START,function(t){return g.onGitOperationStart(t)}),this.gitService.addListener2(m.ServiceEvents.OPERATION_END,function(t){return g.onGitOperationEnd(t)}),this.gitService.getModel().addListener2(m.ModelEvents.MODEL_UPDATED,this.onGitModelUpdate.bind(this))]}return n(e,t),Object.defineProperty(e.prototype,"element",{get:function(){return this.render(),this.$el.getHTMLElement()},enumerable:!0,configurable:!0}),e.prototype.render=function(){var t=this;if(!this.$el){this.$el=x(".changes-view"),this.$commitView=x(".commit-view").appendTo(this.$el),this.commitInputBox=new A.InputBox(this.$commitView.getHTMLElement(),this.contextViewService,{placeholder:o.localize(3,null,e.COMMIT_KEYBINDING),validationOptions:{showMessage:!0,validation:function(n){var i=t.configurationService.getConfiguration("git");return i.enableLongCommitWarning&&/^[^\n]{51}/.test(n)?{content:e.LONG_COMMIT,type:A.MessageType.WARNING}:null}},ariaLabel:o.localize(4,null,e.COMMIT_KEYBINDING),flexibleHeight:!0}),this.commitInputBox.onDidChange(function(e){return t.emit("change",e)}),this.commitInputBox.onDidHeightChange(function(e){return t.emit("heightchange",e)}),x(this.commitInputBox.inputElement).on("keydown",function(n){var i=new f.StandardKeyboardEvent(n);(i.equals(P.CommonKeybindings.CTRLCMD_ENTER)||i.equals(P.CommonKeybindings.CTRLCMD_S))&&(t.smartCommitAction.enabled?t.actionRunner.run(t.smartCommitAction).done():t.commitInputBox.showMessage({content:e.NOTHING_TO_COMMIT,formatContent:!0,type:A.MessageType.INFO}))}).on("blur",function(){t.commitInputBox.hideMessage()}),this.$statusView=x(".status-view").appendTo(this.$el);var n=this.instantiationService.createInstance(w.ActionProvider),i=this.instantiationService.createInstance(w.Renderer,n,this.actionRunner),r=this.instantiationService.createInstance(w.DragAndDrop),s=this.instantiationService.createInstance(w.Controller,n);this.tree=new S.Tree(this.$statusView.getHTMLElement(),{dataSource:new w.DataSource,renderer:i,filter:new w.Filter,sorter:new w.Sorter,accessibilityProvider:new w.AccessibilityProvider,dnd:r,controller:s},{indentPixels:0,twistiePixels:20,ariaLabel:o.localize(5,null)}),this.tree.setInput(this.gitService.getModel().getStatus()),this.tree.expandAll(this.gitService.getModel().getStatus().getGroups()),this.toDispose.push(this.tree.addListener2("selection",function(e){return t.onSelection(e)})),this.toDispose.push(this.commitInputBox.onDidHeightChange(function(){return t.layout()}))}},e.prototype.focus=function(){var t=this.tree.getSelection();t.length>0&&this.tree.reveal(t[0],.5).done(null,l.onUnexpectedError),this.commitInputBox.focus()},e.prototype.layout=function(t){if(void 0===t&&(t=this.currentDimension),t){this.currentDimension=t,this.commitInputBox.layout();var e=t.height-(this.commitInputBox.height+12);this.$statusView.size(t.width,e),this.tree.layout(e),134===this.commitInputBox.height?this.$commitView.addClass("scroll"):this.$commitView.removeClass("scroll")}},e.prototype.setVisible=function(t){return this.visible=t,t?(this.tree.onVisible(),this.onEditorsChanged(this.editorService.getActiveEditorInput())):(this.tree.onHidden(),h.TPromise.as(null))},e.prototype.getControl=function(){return this.tree},e.prototype.getActions=function(){var t=this;return this.actions||(this.actions=[this.smartCommitAction,this.instantiationService.createInstance(E.RefreshAction)],this.actions.forEach(function(e){return t.toDispose.push(e)})),this.actions},e.prototype.getSecondaryActions=function(){var t=this;return this.secondaryActions||(this.secondaryActions=[this.instantiationService.createInstance(E.SyncAction,E.SyncAction.ID,E.SyncAction.LABEL),this.instantiationService.createInstance(E.PullAction,E.PullAction.ID,E.PullAction.LABEL),this.instantiationService.createInstance(E.PullWithRebaseAction),this.instantiationService.createInstance(E.PushAction,E.PushAction.ID,E.PushAction.LABEL),new d.Separator,this.instantiationService.createInstance(E.PublishAction,E.PublishAction.ID,E.PublishAction.LABEL),new d.Separator,this.instantiationService.createInstance(E.CommitAction,this),this.instantiationService.createInstance(E.StageAndCommitAction,this),this.instantiationService.createInstance(E.UndoLastCommitAction,E.UndoLastCommitAction.ID,E.UndoLastCommitAction.LABEL),new d.Separator,this.instantiationService.createInstance(E.GlobalUnstageAction),this.instantiationService.createInstance(E.GlobalUndoAction),new d.Separator,new v.Action("show.gitOutput",o.localize(6,null),null,(!0),function(){
return t.outputService.getChannel("Git").show()})],this.secondaryActions.forEach(function(e){return t.toDispose.push(e)})),this.secondaryActions},e.prototype.getCommitMessage=function(){return u.trim(this.commitInputBox.value)},e.prototype.onEmptyCommitMessage=function(){this.commitInputBox.focus(),this.commitInputBox.showMessage({content:e.NEED_MESSAGE,formatContent:!0,type:A.MessageType.INFO})},e.prototype.onGitModelUpdate=function(){var t=this;this.tree&&this.tree.refresh().done(function(){return t.tree.expandAll(t.gitService.getModel().getStatus().getGroups())})},e.prototype.onEditorsChanged=function(t){var e=this;if(!this.tree)return h.TPromise.as(null);var n=this.getStatusFromInput(t);return n||this.tree.clearSelection(),this.visible&&this.tree.getSelection().indexOf(n)===-1?this.tree.reveal(n,.5).then(function(){e.tree.setSelection([n],{origin:"implicit"})}):h.TPromise.as(null)},e.prototype.onSelection=function(t){var e=this;if(!(t.payload&&t.payload&&"implicit"===t.payload.origin||1!==t.selection.length)){var n=t.selection[0];if(n instanceof y.FileStatus&&(!t.payload||"keyboard"!==t.payload.origin||t.payload.originalEvent.equals(P.CommonKeybindings.ENTER))){var i=t.payload&&"mouse"===t.payload.origin;if(!i||!t.payload.originalEvent.metaKey&&!t.payload.originalEvent.shiftKey){var r=i&&t.payload.originalEvent&&2===t.payload.originalEvent.detail,o=n;this.gitService.getInput(o).done(function(n){var o=new I.TextDiffEditorOptions;if(i){o.preserveFocus=!0;var s=t&&t.payload&&"mouse"===t.payload.origin&&t.payload.originalEvent;s&&2===s.detail&&(o.preserveFocus=!1,s.preventDefault())}o.forceOpen=!0,o.pinned=r;var a=t&&t.payload&&t.payload.originalEvent&&t.payload.originalEvent.altKey;return e.editorService.openEditor(n,o,a)},function(t){return t.gitErrorCode===m.GitErrorCodes.CantOpenResource?void e.messageService.show(_["default"].Warning,t):void e.messageService.show(_["default"].Error,t)})}}}},e.prototype.onGitOperationStart=function(t){t.id===m.ServiceOperations.COMMIT&&this.commitInputBox&&this.commitInputBox.disable()},e.prototype.onGitOperationEnd=function(t){t.operation.id===m.ServiceOperations.COMMIT&&this.commitInputBox&&(this.commitInputBox.enable(),t.error||(this.commitInputBox.value=""))},e.prototype.getStatusFromInput=function(t){if(!t)return null;if(t instanceof b.GitDiffEditorInput)return t.getFileStatus();if(t instanceof b.NativeGitIndexStringEditorInput)return t.getFileStatus()||null;if(t instanceof D.FileEditorInput){var e=t,n=e.getResource(),i=this.contextService.getWorkspace().resource.fsPath;if(!i||!p.isEqualOrParent(n.fsPath,i))return null;var r=this.gitService.getModel().getRepositoryRoot();if(!r||!p.isEqualOrParent(n.fsPath,r))return null;var o=p.normalize(p.relative(r,n.fsPath)),s=this.gitService.getModel().getStatus().getWorkingTreeStatus().find(o);if(s&&(s.getStatus()===m.Status.UNTRACKED||s.getStatus()===m.Status.IGNORED))return s;if(s=this.gitService.getModel().getStatus().getMergeStatus().find(o))return s}return null},e.prototype.dispose=function(){this.$el&&(this.$el.dispose(),this.$el=null),this.toDispose=a.dispose(this.toDispose),t.prototype.dispose.call(this)},e.COMMIT_KEYBINDING=s.isMacintosh?"Cmd+Enter":"Ctrl+Enter",e.NEED_MESSAGE=o.localize(0,null,e.COMMIT_KEYBINDING),e.NOTHING_TO_COMMIT=o.localize(1,null,e.COMMIT_KEYBINDING),e.LONG_COMMIT=o.localize(2,null),e=i([r(1,O.IInstantiationService),r(2,R.IWorkbenchEditorService),r(3,N.IEditorGroupService),r(4,V.IMessageService),r(5,C.IContextViewService),r(6,G.IWorkspaceContextService),r(7,k),r(8,T.IOutputService),r(9,M.IEventService),r(10,B.IConfigurationService)],e)}(c.EventEmitter);e.ChangesView=L}),define(t[38],e([0,1,43,13,6,10,34,2,7,8,15,67,9,14,21]),function(t,e,o,s,a,c,u,l,p,h,g,f,v,d){"use strict";var S=h.IGitService,m=p.$,E=function(t){function e(e,n,i,r,o,s){t.call(this),this.ID="empty",this.gitService=i,this.instantiationService=r,this.messageService=o,this.fileService=s,this.actionRunner=n,this.isVisible=!1,this.needsRender=!1,this.controller=e,this.toDispose=[]}return n(e,t),Object.defineProperty(e.prototype,"initAction",{get:function(){return this._initAction||(this._initAction=this.instantiationService.createInstance(g.InitAction)),this._initAction},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"element",{get:function(){return this.render(),this.$el.getHTMLElement()},enumerable:!0,configurable:!0}),e.prototype.render=function(){var t=this;if(!this.$el){this.$el=m(".empty-view"),m("p").appendTo(this.$el).text(e.EMPTY_MESSAGE);var n=m(".section").appendTo(this.$el);this.initButton=new u.Button(n),this.initButton.label=o.localize(1,null),this.initButton.addListener2("click",function(e){c.EventHelper.stop(e),t.disableUI(),t.actionRunner.run(t.initAction).done(function(){t.enableUI()})}),this.toDispose.push(this.gitService.addListener2(h.ServiceEvents.OPERATION,function(){return t.onGitOperation()}))}},e.prototype.disableUI=function(){this.urlInputBox&&this.urlInputBox.disable(),this.cloneButton&&(this.cloneButton.enabled=!1),this.initButton.enabled=!1},e.prototype.enableUI=function(){this.gitService.getRunningOperations().length>0||(this.urlInputBox&&(this.urlInputBox.enable(),this.urlInputBox.validate()),this.initButton.enabled=!0)},e.prototype.focus=function(){},e.prototype.layout=function(t){},e.prototype.setVisible=function(t){return this.isVisible=t,l.TPromise.as(null)},e.prototype.getControl=function(){return null},e.prototype.getActions=function(){return this.refreshAction?[this.refreshAction]:[]},e.prototype.getSecondaryActions=function(){return[]},e.prototype.onGitOperation=function(){this.gitService.getRunningOperations().length>0?this.disableUI():this.enableUI()},e.prototype.dispose=function(){this.$el&&(this.$el.dispose(),this.$el=null),this.toDispose=s.dispose(this.toDispose),t.prototype.dispose.call(this)},e.EMPTY_MESSAGE=o.localize(0,null),e=i([r(2,S),r(3,v.IInstantiationService),r(4,d.IMessageService),r(5,f.IFileService)],e)}(a.EventEmitter);e.EmptyView=E}),define(t[68],e([0,1,2,13,69,8,70,41,38,25,28,29,19,30,9,71,72,31]),function(t,e,o,s,a,c,u,l,p,h,g,f,v,d,S,m,E){"use strict";var y=c.IGitService,w=function(t){function e(e,n,i,r){var o=this;t.call(this,u.VIEWLET_ID,e),this.progressService=n,this.instantiationService=i,this.gitService=r,this.progressRunner=null,this.views={},this.toDispose=[];var s=[this.instantiationService.createInstance(l.ChangesView,this.getActionRunner()),this.instantiationService.createInstance(p.EmptyView,this,this.getActionRunner()),this.instantiationService.createInstance(h.GitlessView),new g.NotRootView,new f.NoWorkspaceView,new v.DisabledView,this.instantiationService.createInstance(d.HugeView)];s.forEach(function(t){o.views[t.ID]=t,o.toDispose.push(t)}),this.toUnbind.push(this.gitService.addBulkListener2(function(){return o.onGitServiceChanges()}))}return n(e,t),e.prototype.setView=function(t){if(!this.$el)return o.TPromise.as(null);var e=this.views[t];if(!e)return o.Promise.wrapError(new Error("Could not find view."));if(this.currentView===e)return o.TPromise.as(null);var n=o.TPromise.as(null);this.currentView&&(n=this.currentView.setVisible(!1));var i=e.element;this.currentView=e,this.updateTitleArea();for(var r=this.$el.getHTMLElement();r.firstChild;)r.removeChild(r.firstChild);return r.appendChild(i),e.layout(this.currentDimension),n.then(function(){return e.setVisible(!0)})},e.prototype.create=function(e){return t.prototype.create.call(this,e),this.$el=e.div().addClass("git-viewlet"),o.TPromise.as(null)},e.prototype.setVisible=function(e){var n=this;return e?(this.onGitServiceChanges(),this.gitService.status().done(),t.prototype.setVisible.call(this,e).then(function(){if(n.currentView)return n.currentView.setVisible(e)})):(this.currentView?this.currentView.setVisible(e):o.TPromise.as(null)).then(function(){t.prototype.setVisible.call(n,e)})},e.prototype.focus=function(){t.prototype.focus.call(this),this.currentView&&this.currentView.focus()},e.prototype.layout=function(t){void 0===t&&(t=this.currentDimension),this.currentDimension=t,this.currentView&&this.currentView.layout(t)},e.prototype.getActions=function(){return this.currentView?this.currentView.getActions():[]},e.prototype.getSecondaryActions=function(){return this.currentView?this.currentView.getSecondaryActions():[]},e.prototype.getControl=function(){return this.currentView?this.currentView.getControl():null},e.prototype.onGitServiceChanges=function(){this.progressRunner&&this.progressRunner.done(),this.gitService.getState()===c.ServiceState.NoGit?(this.setView("gitless"),this.progressRunner=null):this.gitService.getState()===c.ServiceState.Disabled?(this.setView("disabled"),this.progressRunner=null):this.gitService.getState()===c.ServiceState.NotARepo?(this.setView("empty"),this.progressRunner=null):this.gitService.getState()===c.ServiceState.NotAWorkspace?(this.setView("noworkspace"),this.progressRunner=null):this.gitService.getState()===c.ServiceState.NotAtRepoRoot?(this.setView("notroot"),this.progressRunner=null):this.gitService.getState()===c.ServiceState.Huge?(this.setView("huge"),this.progressRunner=null):this.gitService.isIdle()?(this.setView("changes"),this.progressRunner=null):this.progressRunner=this.progressService.show(!0)},e.prototype.dispose=function(){this.toDispose=s.dispose(this.toDispose),this.views=null,t.prototype.dispose.call(this)},e=i([r(0,E.ITelemetryService),r(1,m.IProgressService),r(2,S.IInstantiationService),r(3,y)],e)}(a.Viewlet);e.GitViewlet=w})}).call(this);
//# sourceMappingURL=https://ticino.blob.core.windows.net/sourcemaps/e6b4afa53e9c0f54edef1673de9001e9f0f547ae/vs\workbench\parts\git\browser\gitViewlet.js.map
