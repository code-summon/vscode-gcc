/*!--------------------------------------------------------
 * Copyright (C) Microsoft Corporation. All rights reserved.
 *--------------------------------------------------------*/
(function(){var e=["vs/workbench/parts/terminal/electron-browser/terminalInstance","exports","vs/base/browser/dom","vs/base/common/lifecycle","vs/base/common/platform","require","xterm","vs/workbench/parts/terminal/electron-browser/terminalPanel","vs/base/browser/builder","vs/workbench/parts/terminal/electron-browser/terminalConfigHelper","vs/platform/configuration/common/configuration","vs/platform/instantiation/common/instantiation","vs/platform/telemetry/common/telemetry","vs/workbench/parts/terminal/electron-browser/terminal","vs/workbench/services/themes/common/themeService","vs/platform/workspace/common/workspace","vs/workbench/browser/panel","vs/base/common/winjs.base","vs/workbench/parts/terminal/electron-browser/terminalActions"],t=function(t){for(var n=[],i=0,r=t.length;i<r;i++)n[i]=e[t[i]];return n};define(e[0],t([5,1,2,3,4,6]),function(e,t,n,i,r,o){"use strict";var s=function(){function e(e,t,i,s,a){var c=this;this.terminalProcess=e,this.parentDomElement=t,this.contextService=i,this.terminalService=s,this.onExitCallback=a,this.isExiting=!1,this.toDispose=[],this.wrapperElement=document.createElement("div"),n.addClass(this.wrapperElement,"terminal-wrapper"),this.terminalDomElement=document.createElement("div"),this.xterm=o(),this.terminalProcess.process.on("message",function(e){"data"===e.type&&c.xterm.write(e.content)}),this.xterm.on("data",function(e){return c.terminalProcess.process.send({event:"input",data:e}),!1}),this.terminalProcess.process.on("exit",function(e){c.isExiting||(c.isExiting=!0,c.dispose(),e&&console.error("Integrated terminal exited with code "+e),c.onExitCallback(c))}),this.toDispose.push(n.addDisposableListener(this.parentDomElement,"mousedown",function(e){2===e.which&&r.isLinux&&c.focus(!0)})),this.toDispose.push(n.addDisposableListener(this.parentDomElement,"mouseup",function(e){3!==e.which&&c.focus()})),this.toDispose.push(n.addDisposableListener(this.parentDomElement,"keyup",function(e){27===e.keyCode&&e.stopPropagation()})),this.xterm.open(this.terminalDomElement),this.wrapperElement.appendChild(this.terminalDomElement),this.parentDomElement.appendChild(this.wrapperElement)}return e.prototype.layout=function(e){if(this.font&&this.font.charWidth&&this.font.charHeight&&e.height){var t=Math.floor(e.width/this.font.charWidth),n=Math.floor(e.height/this.font.charHeight);this.xterm&&this.xterm.resize(t,n),this.terminalProcess.process.connected&&this.terminalProcess.process.send({event:"resize",cols:t,rows:n})}},e.prototype.toggleVisibility=function(e){n.toggleClass(this.wrapperElement,"active",e)},e.prototype.setFont=function(e){this.font=e,this.terminalDomElement.style.fontFamily=this.font.fontFamily,this.terminalDomElement.style.lineHeight=this.font.lineHeight,this.terminalDomElement.style.fontSize=this.font.fontSize},e.prototype.setCursorBlink=function(e){this.xterm&&this.xterm.cursorBlink!==e&&(this.xterm.cursorBlink=e,this.xterm.refresh(0,this.xterm.rows-1))},e.prototype.focus=function(e){if(this.xterm){var t=window.getSelection().toString();t&&!e||this.xterm.focus()}},e.prototype.dispose=function(){this.wrapperElement&&(this.parentDomElement.removeChild(this.wrapperElement),this.wrapperElement=null),this.xterm&&(this.xterm.destroy(),this.xterm=null),this.terminalProcess&&(this.terminalService.killTerminalProcess(this.terminalProcess),this.terminalProcess=null),this.toDispose=i.dispose(this.toDispose)},e}();t.TerminalInstance=s});var n=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},r=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}};define(e[7],t([5,1,2,3,4,8,18,10,11,12,13,14,15,16,17,9,0]),function(e,t,o,s,a,c,l,m,h,p,u,f,d,v,g,I,w){"use strict";var y=function(e){function t(t,n,i,r,o,s){e.call(this,u.TERMINAL_PANEL_ID,t),this.configurationService=n,this.instantiationService=i,this.contextService=r,this.terminalService=o,this.themeService=s,this.toDispose=[],this.terminalInstances=[]}return n(t,e),t.prototype.layout=function(e){if(e){var t=this.terminalService.getActiveTerminalIndex();t!==-1&&this.terminalInstances.length>0&&this.terminalInstances[this.terminalService.getActiveTerminalIndex()].layout(e)}},t.prototype.getActions=function(){var e=this;return this.actions||(this.actions=[this.instantiationService.createInstance(l.SwitchTerminalInstanceAction,l.SwitchTerminalInstanceAction.ID,l.SwitchTerminalInstanceAction.LABEL),this.instantiationService.createInstance(l.CreateNewTerminalAction,l.CreateNewTerminalAction.ID,l.CreateNewTerminalAction.PANEL_LABEL),this.instantiationService.createInstance(l.KillTerminalAction,l.KillTerminalAction.ID,l.KillTerminalAction.PANEL_LABEL)],this.actions.forEach(function(t){e.toDispose.push(t)})),this.actions},t.prototype.getActionItem=function(t){return t.id===l.SwitchTerminalInstanceAction.ID?this.instantiationService.createInstance(l.SwitchTerminalInstanceActionItem,t):e.prototype.getActionItem.call(this,t)},t.prototype.create=function(t){return e.prototype.create.call(this,t),this.parentDomElement=t.getHTMLElement(),this.terminalService.initConfigHelper(t),o.addClass(this.parentDomElement,"integrated-terminal"),this.themeStyleElement=document.createElement("style"),this.terminalContainer=document.createElement("div"),o.addClass(this.terminalContainer,"terminal-outer-container"),this.parentDomElement.appendChild(this.themeStyleElement),this.parentDomElement.appendChild(this.terminalContainer),this.configurationHelper=new I.TerminalConfigHelper(a.platform,this.configurationService,t),this.terminalService.createNew()},t.prototype.createNewTerminalInstance=function(e){var t=this;return this.createTerminal(e).then(function(){t.updateConfig(),t.focus()})},t.prototype.closeActiveTerminal=function(){return this.closeTerminal(this.terminalService.getActiveTerminalIndex())},t.prototype.closeTerminal=function(e){var t=this;return new g.TPromise(function(n){t.onTerminalInstanceExit(t.terminalInstances[e])})},t.prototype.setVisible=function(t){var n=this;if(t){if(!(this.terminalInstances.length>0))return e.prototype.setVisible.call(this,t).then(function(){n.terminalService.createNew()});this.updateConfig(),this.updateTheme()}return e.prototype.setVisible.call(this,t)},t.prototype.createTerminal=function(e){var t=this;return new g.TPromise(function(n){var i=new w.TerminalInstance(e,t.terminalContainer,t.contextService,t.terminalService,t.onTerminalInstanceExit.bind(t));t.terminalInstances.push(i),t.setActiveTerminal(t.terminalInstances.length-1),t.toDispose.push(t.themeService.onDidThemeChange(t.updateTheme.bind(t))),t.toDispose.push(t.configurationService.onDidUpdateConfiguration(t.updateConfig.bind(t))),t.updateTheme(),t.updateConfig(),n(i)})},t.prototype.setActiveTerminal=function(e){this.terminalInstances.forEach(function(t,n){t.toggleVisibility(n===e)})},t.prototype.onTerminalInstanceExit=function(e){var t=this.terminalInstances.indexOf(e);t!==-1&&(this.terminalInstances[t].dispose(),this.terminalInstances.splice(t,1)),this.terminalInstances.length>0&&this.setActiveTerminal(this.terminalService.getActiveTerminalIndex()),0===this.terminalInstances.length?this.terminalService.hide():this.terminalService.focus()},t.prototype.updateTheme=function(e){var t=this;e||(e=this.themeService.getTheme());var n=this.configurationHelper.getTheme(e),i="";n.forEach(function(e,n){var r=t.convertHexCssColorToRgba(e,.996);i+=".monaco-workbench .panel.integrated-terminal .xterm .xterm-color-"+n+" { color: "+e+"; }"+(".monaco-workbench .panel.integrated-terminal .xterm .xterm-color-"+n+"::selection { background-color: "+r+"; }")+(".monaco-workbench .panel.integrated-terminal .xterm .xterm-bg-color-"+n+" { background-color: "+e+"; }")+(".monaco-workbench .panel.integrated-terminal .xterm .xterm-bg-color-"+n+"::selection { color: "+e+"; }")}),this.themeStyleElement.innerHTML=i},t.prototype.convertHexCssColorToRgba=function(e,t){var n=parseInt(e.substr(1,2),16),i=parseInt(e.substr(3,2),16),r=parseInt(e.substr(5,2),16);return"rgba("+n+", "+i+", "+r+", "+t+")"},t.prototype.updateConfig=function(){this.updateFont(),this.updateCursorBlink()},t.prototype.updateFont=function(){0!==this.terminalInstances.length&&(this.terminalInstances[this.terminalService.getActiveTerminalIndex()].setFont(this.configurationHelper.getFont()),this.layout(new c.Dimension(this.parentDomElement.offsetWidth,this.parentDomElement.offsetHeight)))},t.prototype.updateCursorBlink=function(){var e=this;this.terminalInstances.forEach(function(t){t.setCursorBlink(e.configurationHelper.getCursorBlink())})},t.prototype.focus=function(){var e=this.terminalService.getActiveTerminalIndex();e!==-1&&this.terminalInstances.length>0&&this.terminalInstances[e].focus(!0)},t.prototype.dispose=function(){for(this.toDispose=s.dispose(this.toDispose);this.terminalInstances.length>0;)this.terminalInstances.pop().dispose();e.prototype.dispose.call(this)},t=i([r(0,p.ITelemetryService),r(1,m.IConfigurationService),r(2,h.IInstantiationService),r(3,d.IWorkspaceContextService),r(4,u.ITerminalService),r(5,f.IThemeService)],t)}(v.Panel);t.TerminalPanel=y})}).call(this);
//# sourceMappingURL=https://ticino.blob.core.windows.net/sourcemaps/e6b4afa53e9c0f54edef1673de9001e9f0f547ae/vs\workbench\parts\terminal\electron-browser\terminalPanel.js.map
