/*!--------------------------------------------------------
 * Copyright (C) Microsoft Corporation. All rights reserved.
 *--------------------------------------------------------*/
(function(){var e=["require","exports","vs/platform/configuration/common/configuration","vs/base/common/winjs.base","vs/nls!vs/workbench/parts/search/browser/openAnythingHandler","vs/base/common/labels","vs/base/parts/quickopen/browser/quickOpenModel","vs/workbench/browser/quickopen","vs/platform/instantiation/common/instantiation","vs/base/common/paths","vs/nls!vs/workbench/parts/search/browser/openSymbolHandler","vs/platform/search/common/search","vs/workbench/parts/search/common/searchQuery","vs/workbench/parts/search/browser/openFileHandler","vs/nls","vs/workbench/services/editor/common/editorService","vs/nls!vs/workbench/parts/search/browser/openFileHandler","vs/platform/message/common/message","vs/platform/workspace/common/workspace","vs/workbench/parts/search/browser/openSymbolHandler","vs/base/common/async","vs/workbench/services/workspace/common/contextService","vs/workbench/services/group/common/groupService","vs/base/common/objects","vs/workbench/parts/files/common/files","vs/base/common/filters","vs/editor/common/services/modeService","vs/workbench/parts/search/common/search","vs/workbench/parts/search/browser/openAnythingHandler","vs/base/common/types","vs/base/common/platform","vs/base/common/scorer","vs/base/common/strings","vs/workbench/common/editor"],t=function(t){for(var r=[],n=0,i=t.length;n<i;n++)r[n]=e[t[n]];return r};define(e[16],t([14,4]),function(e,t){return e.create("vs/workbench/parts/search/browser/openFileHandler",t)}),define(e[10],t([14,4]),function(e,t){return e.create("vs/workbench/parts/search/browser/openSymbolHandler",t)});var r=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},n=this&&this.__param||function(e,t){return function(r,n){t(r,n,e)}};define(e[12],t([0,1,23,11,2]),function(e,t,i,o,s){"use strict";function c(e){var t=e&&e.files&&e.files.exclude,r=e&&e.search&&e.search.exclude;if(!t&&!r)return null;if(!t||!r)return t||r;var n=Object.create(null);return n=i.mixin(n,t),n=i.mixin(n,r,!0)}t.getExcludes=c;var a=function(){function e(e){this.configurationService=e}return e.prototype.text=function(e,t){return this.query(o.QueryType.Text,e,t)},e.prototype.file=function(e){return this.query(o.QueryType.File,null,e)},e.prototype.query=function(e,t,r){void 0===r&&(r={});var n=this.configurationService.getConfiguration(),o=c(n);return r.excludePattern?i.mixin(r.excludePattern,o,!1):r.excludePattern=o,{type:e,folderResources:r.folderResources,extraFileResources:r.extraFileResources,filePattern:r.filePattern,excludePattern:r.excludePattern,includePattern:r.includePattern,maxResults:r.maxResults,fileEncoding:r.fileEncoding,contentPattern:t}},e=r([n(0,s.IConfigurationService)],e)}();t.QueryBuilder=a});var i=this&&this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)};define(e[13],t([0,1,3,16,9,5,6,7,12,24,33,22,15,2,8,17,11,18]),function(e,t,o,s,c,a,u,l,h,p,f,v,m,g,d,S,y,b){"use strict";var E=function(e){function t(t,r,n,i,o,s,c){e.call(this,i),this.instantiationService=o,this.configurationService=s,this.resource=n,this.name=t,this.description=r}return i(t,e),t.prototype.getLabel=function(){return this.name},t.prototype.getAriaLabel=function(){return s.localize(0,null,this.getLabel())},t.prototype.getDescription=function(){return this.description},t.prototype.getIcon=function(){return"file"},t.prototype.getResource=function(){return this.resource},t.prototype.setRange=function(e){this.range=e},t.prototype.getInput=function(){var e={resource:this.resource,options:{pinned:!this.configurationService.getConfiguration().workbench.editor.enablePreviewFromQuickOpen}};return this.range&&(e.options.selection=this.range),e},t=r([n(3,m.IWorkbenchEditorService),n(4,d.IInstantiationService),n(5,g.IConfigurationService),n(6,b.IWorkspaceContextService)],t)}(l.EditorQuickOpenEntry);t.FileEntry=E;var k=function(e){function t(t,r,n,i,o,s,c,a){e.call(this),this.editorService=t,this.editorGroupService=r,this.messageService=n,this.instantiationService=i,this.configurationService=o,this.contextService=s,this.textFileService=c,this.searchService=a,this.queryBuilder=this.instantiationService.createInstance(h.QueryBuilder)}return i(t,e),t.prototype.getResults=function(e){e=e.trim();var t;return t=e?this.doFindResults(e):o.TPromise.as([]),t.then(function(e){return new u.QuickOpenModel(e)})},t.prototype.doFindResults=function(e){var t=this,r={folderResources:this.contextService.getWorkspace()?[this.contextService.getWorkspace().resource]:[],extraFileResources:f.getOutOfWorkspaceEditorResources(this.editorGroupService,this.contextService),filePattern:e};return this.searchService.search(this.queryBuilder.file(r)).then(function(e){for(var r=[],n=0;n<e.results.length;n++){var i=e.results[n],o=c.basename(i.resource.fsPath),s=a.getPathLabel(c.dirname(i.resource.fsPath),t.contextService);r.push(t.instantiationService.createInstance(E,o,s,i.resource))}return r})},t.prototype.getGroupLabel=function(){return s.localize(1,null)},t.prototype.getAutoFocus=function(e){return{autoFocusFirstEntry:!0}},t=r([n(0,m.IWorkbenchEditorService),n(1,v.IEditorGroupService),n(2,S.IMessageService),n(3,d.IInstantiationService),n(4,g.IConfigurationService),n(5,b.IWorkspaceContextService),n(6,p.ITextFileService),n(7,y.ISearchService)],t)}(l.QuickOpenHandler);t.OpenFileHandler=k}),define(e[19],t([0,1,3,10,20,7,6,25,5,15,8,18,26,2,27]),function(e,t,o,s,c,a,u,l,h,p,f,v,m,g,d){"use strict";var S=function(e){function t(t,r,n,i,o,s,c,a,u){e.call(this,a),this.configurationService=u,this.name=t,this.parameters=r,this.description=n,this.resource=i,this.type=o,this.range=s,this.setHighlights(c)}return i(t,e),t.prototype.getLabel=function(){return this.name+this.parameters},t.prototype.getAriaLabel=function(){return s.localize(0,null,this.getLabel())},t.prototype.getName=function(){return this.name},t.prototype.getParameters=function(){return this.parameters},t.prototype.getDescription=function(){return this.description},t.prototype.getType=function(){return this.type},t.prototype.getIcon=function(){return this.type},t.prototype.getInput=function(){var e={resource:this.resource,options:{pinned:!this.configurationService.getConfiguration().workbench.editor.enablePreviewFromQuickOpen}};return this.range&&(e.options.selection={startLineNumber:this.range.startLineNumber,startColumn:this.range.startColumn}),e},t=r([n(7,p.IWorkbenchEditorService),n(8,g.IConfigurationService)],t)}(a.EditorQuickOpenEntry),y=function(e){function t(r,n,i,o){e.call(this),this.editorService=r,this.modeService=n,this.instantiationService=i,this.contextService=o,this.delayer=new c.ThrottledDelayer(t.SEARCH_DELAY),this.options=Object.create(null)}return i(t,e),t.prototype.setOptions=function(e){this.options=e},t.prototype.canRun=function(){return!0},t.prototype.getResults=function(e){var t=this;e=e.trim();var r;return r=e?this.options.skipDelay?this.doGetResults(e):this.delayer.trigger(function(){return t.doGetResults(e)}):o.TPromise.as([]),r.then(function(e){return new u.QuickOpenModel(e)})},t.prototype.doGetResults=function(e){var t=this;return d.getNavigateToItems(e).then(function(r){return t.toQuickOpenEntries(r,e)})},t.prototype.toQuickOpenEntries=function(e,t){var r=this,n=[];return e.forEach(function(e){if(!r.options.skipLocalSymbols||!e.containerName){var i=l.matchesFuzzy(t,e.name);if(i){var o=e.resourceUri;if("file"===o.scheme){var s=h.getPathLabel(o,r.contextService),c=void 0;c=e.containerName===s?s:e.containerName===o.toString()&&e.containerName.indexOf("/")>=0?e.containerName.substr(e.containerName.lastIndexOf("/")+1):e.containerName&&e.containerName.indexOf(".")>=0?e.containerName.substr(e.containerName.lastIndexOf(".")+1):e.containerName||s,n.push(r.instantiationService.createInstance(S,e.name,e.parameters,c,o,e.type,e.range,i))}}}}),this.options.skipSorting?n:n.sort(this.sort.bind(this,t.toLowerCase()))},t.prototype.sort=function(e,t,r){var n=t.getName().toLowerCase(),i=r.getName().toLowerCase();if(n===i){var o=t.getType(),s=r.getType();return o.localeCompare(s)}return u.QuickOpenEntry.compare(t,r,e)},t.prototype.getGroupLabel=function(){return s.localize(1,null)},t.prototype.getEmptyLabel=function(e){return e.length>0?s.localize(2,null):s.localize(3,null)},t.prototype.getAutoFocus=function(e){return{autoFocusFirstEntry:!0,autoFocusPrefixMatch:e.trim()}},t.SEARCH_DELAY=500,t=r([n(0,p.IWorkbenchEditorService),n(1,m.IModeService),n(2,f.IInstantiationService),n(3,v.IWorkspaceContextService)],t)}(a.QuickOpenHandler);t.OpenSymbolHandler=y}),define(e[28],t([0,1,3,4,20,29,30,31,9,5,32,6,7,13,19,17,8,21,2]),function(e,t,o,s,c,a,u,l,h,p,f,v,m,g,d,S,y,b,E){"use strict";t.OpenSymbolHandler=d.OpenSymbolHandler;var k=function(e){function m(r,n,i,o){e.call(this),this.messageService=r,this.contextService=n,this.configurationService=o,this.openSymbolHandler=i.createInstance(t.OpenSymbolHandler),this.openFileHandler=i.createInstance(g.OpenFileHandler),this.openSymbolHandler.setOptions({skipDelay:!0,skipLocalSymbols:!0,skipSorting:!0}),this.resultsToSearchCache=Object.create(null),this.scorerCache=Object.create(null),this.delayer=new c.ThrottledDelayer(m.SEARCH_DELAY)}return i(m,e),m.prototype.getResults=function(e){var t=this;if(e=e.replace(/ /g,""),u.isWindows&&(e=e.replace(/\//g,"\\")),this.cancelPendingSearch(),this.isClosed=!1,!e)return o.TPromise.as(new v.QuickOpenModel);var r=this.extractRange(e);r&&(e=r.search);var n=this.getResultsFromCache(e,r?r.range:null);if(n)return o.TPromise.as(new v.QuickOpenModel(n));var i=function(){var n=!1,i=[];if(r)i.push(o.TPromise.as(new v.QuickOpenModel));else{var s=function(e){return o.TPromise.timeout(e).then(function(){return n?o.TPromise.as(new v.QuickOpenModel):s(m.SYMBOL_SEARCH_SUBSEQUENT_TIMEOUT)})},c=t.openSymbolHandler.getResults(e),a=s(m.SYMBOL_SEARCH_INITIAL_TIMEOUT);i.push(o.TPromise.any([c,a]).then(function(e){return e.value}))}return i.push(t.openFileHandler.getResults(e).then(function(e){return n=!0,e})),t.pendingSearch=o.TPromise.join(i).then(function(n){if(t.pendingSearch=null,t.isClosed)return o.TPromise.as(new v.QuickOpenModel);var i=n[0].entries.concat(n[1].entries),s=f.stripWildcards(e).toLowerCase();i.sort(function(r,n){return v.QuickOpenEntry.compareByScore(r,n,e,s,t.scorerCache)}),i.forEach(function(e){e instanceof g.FileEntry&&e.setRange(r?r.range:null)}),t.resultsToSearchCache[e]=i;var c=i.length>m.MAX_DISPLAYED_RESULTS?i.slice(0,m.MAX_DISPLAYED_RESULTS):i;return c.forEach(function(t){if(t instanceof g.FileEntry){var r=v.QuickOpenEntry.highlight(t,e,!0),n=r.labelHighlights,i=r.descriptionHighlights;t.setHighlights(n,i)}}),o.TPromise.as(new v.QuickOpenModel(c))},function(e){t.pendingSearch=null,t.messageService.show(S.Severity.Error,e)}),t.pendingSearch};return this.delayer.trigger(i)},m.prototype.extractRange=function(e){var t=null,r=m.LINE_COLON_PATTERN.exec(e);if(r&&r.length>1){var n=parseInt(r[1],10);if(a.isNumber(n)){if(t={startLineNumber:n,startColumn:1,endLineNumber:n,endColumn:1},r.length>3){var i=parseInt(r[3],10);a.isNumber(i)&&(t.startColumn=i,t.endColumn=i)}}else""===r[1]&&(t={startLineNumber:1,startColumn:1,endLineNumber:1,endColumn:1})}return t?{search:e.substr(0,r.index),range:t}:null},m.prototype.getResultsFromCache=function(e,t){var r=this;if(void 0===t&&(t=null),h.isAbsolute(e))return null;var n;for(var i in this.resultsToSearchCache)if(0===e.indexOf(i)){if(e.indexOf(h.nativeSep)>=0&&i.indexOf(h.nativeSep)<0)continue;n=this.resultsToSearchCache[i];break}if(!n)return null;for(var o=[],s=f.stripWildcards(e).toLowerCase(),c=0;c<n.length;c++){var a=n[c];if(!t||a instanceof g.FileEntry){var u=a.getResource(),d=u?p.getPathLabel(u,this.contextService):a.getLabel();l.matches(d,s)&&o.push(a)}}o.sort(function(t,n){return v.QuickOpenEntry.compareByScore(t,n,e,s,r.scorerCache)}),o.forEach(function(e){e instanceof g.FileEntry&&e.setRange(t)});var S=o.length>m.MAX_DISPLAYED_RESULTS?o.slice(0,m.MAX_DISPLAYED_RESULTS):o;return S.forEach(function(t){var r=v.QuickOpenEntry.highlight(t,e,!0),n=r.labelHighlights,i=r.descriptionHighlights;t.setHighlights(n,i)}),S},m.prototype.getGroupLabel=function(){return s.localize(0,null)},m.prototype.getAutoFocus=function(e){return{autoFocusFirstEntry:!0}},m.prototype.onClose=function(e){this.isClosed=!0,this.cancelPendingSearch(),this.resultsToSearchCache=Object.create(null),this.scorerCache=Object.create(null),this.openSymbolHandler.onClose(e),this.openFileHandler.onClose(e)},m.prototype.cancelPendingSearch=function(){this.pendingSearch&&(this.pendingSearch.cancel(),this.pendingSearch=null)},m.LINE_COLON_PATTERN=/[#|:|\(](\d*)([#|:|,](\d*))?\)?$/,m.SYMBOL_SEARCH_INITIAL_TIMEOUT=500,m.SYMBOL_SEARCH_SUBSEQUENT_TIMEOUT=100,m.SEARCH_DELAY=300,m.MAX_DISPLAYED_RESULTS=512,m=r([n(0,S.IMessageService),n(1,b.IWorkspaceContextService),n(2,y.IInstantiationService),n(3,E.IConfigurationService)],m)}(m.QuickOpenHandler);t.OpenAnythingHandler=k})}).call(this);
//# sourceMappingURL=https://ticino.blob.core.windows.net/sourcemaps/e6b4afa53e9c0f54edef1673de9001e9f0f547ae/vs\workbench\parts\search\browser\openAnythingHandler.js.map
